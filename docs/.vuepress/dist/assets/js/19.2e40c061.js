(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{505:function(e,t,a){e.exports=a.p+"assets/img/img.49431060.png"},532:function(e,t,a){"use strict";a.r(t);var s=a(29),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h4",{attrs:{id:"硬件需求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#硬件需求"}},[e._v("#")]),e._v(" 硬件需求:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("        内存>=4GB\n        硬盘空间>=20GB\n")])])]),s("h4",{attrs:{id:"软件需求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#软件需求"}},[e._v("#")]),e._v(" 软件需求:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("        ubuntu-16.04操作系统\n")])])]),s("h2",{attrs:{id:"_01、系统检查"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_01、系统检查"}},[e._v("#")]),e._v(" 01、系统检查")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("禁用swap分区")])]),e._v(" "),s("li",[s("p",[e._v("关闭防火墙")])])]),e._v(" "),s("h4",{attrs:{id:"禁用swap分区"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#禁用swap分区"}},[e._v("#")]),e._v(" 禁用swap分区")]),e._v(" "),s("p",[e._v("1.进入系统右击鼠标点击“在终端中打开”")]),e._v(" "),s("p",[e._v("2.输入命令 "),s("code",[e._v("sudo vim /etc/fstab")]),e._v(" 编辑fstab文件")]),e._v(" "),s("p",[e._v("3.键盘输入 i 进入插入模式就可以对文件进行编辑了")]),e._v(" "),s("p",[e._v("4.将UUID=xxx… swap那一行的最前面添加 # 把这行注释")]),e._v(" "),s("p",[e._v("5.按Esc键,再按shift键+:键,输入wq,按Enter键保存")]),e._v(" "),s("h4",{attrs:{id:"关闭防火墙"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#关闭防火墙"}},[e._v("#")]),e._v(" 关闭防火墙")]),e._v(" "),s("p",[e._v("1.首先打开Ubuntu的终端命令行")]),e._v(" "),s("p",[e._v("2.查看当前防火墙状态,使用"),s("code",[e._v("sudo ufw status")]),e._v("命令查看当前防火墙状态;inactive状态是防火墙关闭状态 active是开启状态。")]),e._v(" "),s("p",[e._v("3.使用"),s("code",[e._v("sudo ufw disable")]),e._v("命令来关闭防火墙。执行该命令之后 我们使用sudo ufw status命令来查看当前防火墙的状态 如果是inactive 说明我们的防火墙已经关闭掉了。")]),e._v(" "),s("h2",{attrs:{id:"_02、安装docker-ce"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_02、安装docker-ce"}},[e._v("#")]),e._v(" 02、安装Docker-ce")]),e._v(" "),s("p",[e._v("1.首先打开Ubuntu的终端命令行")]),e._v(" "),s("p",[e._v("2.输入")]),e._v(" "),s("div",{staticClass:"language-commandline line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("sudo apt-get install apt-transport-https ca-certificates curl software-properties-common\n\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("3.输入")]),e._v(" "),s("div",{staticClass:"language-commandline line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add  -\n\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("4.输入")]),e._v(" "),s("div",{staticClass:"language-commandline line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('sudo add-apt-repository  "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("5.输入")]),e._v(" "),s("div",{staticClass:"language-commandline line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("sudo apt-get update\n\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("6.输入")]),e._v(" "),s("div",{staticClass:"language-commandline line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("sudo apt-get install docker-ce=5:20.10.7~3-0~ubuntu-xenial\n\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("7.输入"),s("code",[e._v("docker -v")]),e._v(",显示Docker version 20.10.7,说明已经安装成功.(注意：如果系统已存在docker，但版本不是 20.10.7，请卸载重装)")]),e._v(" "),s("h2",{attrs:{id:"_03、安装kubeadm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_03、安装kubeadm"}},[e._v("#")]),e._v(" 03、安装kubeadm")]),e._v(" "),s("ul",[s("li",[e._v("安装kubeadm")]),e._v(" "),s("li",[e._v("配置kubelet禁用swap")])]),e._v(" "),s("h4",{attrs:{id:"安装kubeadm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装kubeadm"}},[e._v("#")]),e._v(" 安装kubeadm")]),e._v(" "),s("p",[e._v("1.首先打开Ubuntu的终端命令行")]),e._v(" "),s("p",[e._v("2.激活root账户,输入"),s("code",[e._v("sudo passwd root")]),e._v(",按提示输入密码,最好跟sudo的密码保持一致")]),e._v(" "),s("p",[e._v("3.切换roo账户，输入"),s("code",[e._v("su root")]),e._v(",再输入root账户密码")]),e._v(" "),s("p",[e._v("4.输入"),s("code",[e._v("apt-get update && apt-get install -y apt-transport-https")])]),e._v(" "),s("p",[e._v("5.输入"),s("code",[e._v("curl -fsSL https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add -")])]),e._v(" "),s("p",[e._v("6.输入"),s("code",[e._v('add-apt-repository "deb [arch=amd64] https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main"')])]),e._v(" "),s("p",[e._v("7.输入"),s("code",[e._v("apt-get update")])]),e._v(" "),s("p",[e._v("8.输入"),s("code",[e._v("apt install -y kubelet=1.15.4-00 kubectl=1.15.4-00 kubeadm=1.15.4-00")])]),e._v(" "),s("h4",{attrs:{id:"配置kubelet禁用swap"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置kubelet禁用swap"}},[e._v("#")]),e._v(" 配置kubelet禁用swap")]),e._v(" "),s("p",[e._v("1.首先打开Ubuntu的终端命令行")]),e._v(" "),s("p",[e._v("2.输入"),s("code",[e._v("tee /etc/default/kubelet <<-'EOF' KUBELET_EXTRA_ARGS=\"--fail-swap-on=false\" EOF")])]),e._v(" "),s("p",[e._v("3.输入"),s("code",[e._v("systemctl daemon-reload && systemctl restart kubelet")])]),e._v(" "),s("h2",{attrs:{id:"_04、初始化k8s"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_04、初始化k8s"}},[e._v("#")]),e._v(" 04、初始化k8s")]),e._v(" "),s("ul",[s("li",[e._v("初始化k8s")]),e._v(" "),s("li",[e._v("kubectl配置调用")]),e._v(" "),s("li",[e._v("配置k8s网络")])]),e._v(" "),s("h4",{attrs:{id:"初始化k8s"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#初始化k8s"}},[e._v("#")]),e._v(" 初始化k8s")]),e._v(" "),s("p",[e._v("1.重启电脑,然后打开Ubuntu的终端命令行,切换至root账户")]),e._v(" "),s("p",[e._v("2.输入"),s("code",[e._v("kubeadm init \\ --kubernetes-version=v1.15.4 \\ --image-repository registry.aliyuncs.com/google_containers \\ --pod-network-cidr=10.24.0.0/16 \\ --ignore-preflight-errors=Swap")]),e._v("\n整个初始化过程会花几分钟，请耐心等待")]),e._v(" "),s("p",[s("img",{attrs:{src:a(505),alt:"img.png"}})]),e._v(" "),s("p",[e._v("出现红框中的内容时，代表初始化成功")]),e._v(" "),s("h4",{attrs:{id:"kubectl配置调用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kubectl配置调用"}},[e._v("#")]),e._v(" kubectl配置调用")]),e._v(" "),s("p",[e._v("1.打开Ubuntu的终端命令行,切换至root账户")]),e._v(" "),s("p",[e._v("2.输入"),s("code",[e._v("mkdir -p $HOME/.kube")])]),e._v(" "),s("p",[e._v("3.输入"),s("code",[e._v("cp -i /etc/kubernetes/admin.conf $HOME/.kube/config")])]),e._v(" "),s("p",[e._v("4.输入"),s("code",[e._v("chown $(id -u):$(id -g) $HOME/.kube/config")])]),e._v(" "),s("h4",{attrs:{id:"配置k8s网络"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置k8s网络"}},[e._v("#")]),e._v(" 配置k8s网络")]),e._v(" "),s("p",[e._v("1.打开Ubuntu的终端命令行,切换至root账户")]),e._v(" "),s("p",[e._v("2.输入"),s("code",[e._v("kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml")])]),e._v(" "),s("p",[e._v("3.输入"),s("code",[e._v("kubectl get pods -A")]),e._v(",会看到服务都启动成功并正常运行")]),e._v(" "),s("p",[e._v("4.如果coredns两个服务状态不为running,请执行以下步骤进行修复。")]),e._v(" "),s("ul",[s("li",[e._v("4.1打开Ubuntu的终端命令行,切换至root账户")]),e._v(" "),s("li",[e._v("4.2 输入 "),s("code",[e._v("kubectl edit cm coredns -n kube-system")])]),e._v(" "),s("li",[e._v("4.3 删除 loop 保存并退出")]),e._v(" "),s("li",[e._v("4.4 重启 coredns pods,输入"),s("code",[e._v("kubectl delete pod coredns-xxx-xxxx -n kube-system")]),e._v("即可(中间xxx需要替换)")]),e._v(" "),s("li",[e._v("4.5 输入"),s("code",[e._v("kubectl get pods -A")]),e._v(",会看到coredns服务都正常运行")])])])}),[],!1,null,null,null);t.default=r.exports}}]);